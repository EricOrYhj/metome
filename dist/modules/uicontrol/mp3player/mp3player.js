define(function(){function t(t){var e=this;this.options=$.extend({mp3_url:"",wav_url:"",onStop:function(){},onPause:function(){}},t),0==$("#"+this.options.id).length?(this.object="","undefined"==typeof Worker?(this.object+='<OBJECT name="'+this.options.mp3_url+'" classid="CLSID:6BF52A52-394A-11d3-B153-00C04F79FAA6" height="0" width="0" border="0">',this.object+='<param name="URL" value="'+this.options.mp3_url+'">',this.object+='<PARAM NAME="playCount" VALUE="1">',this.object+='<param name="autoStart" value="0">',this.object+='<PARAM NAME="fullScreen" VALUE="0">',this.object+='<PARAM NAME="enableContextMenu" VALUE="0">',this.object+='<PARAM NAME="volume" VALUE="100">',this.object+="</OBJECT>"):(this.object+='<audio name="'+this.options.mp3_url+'">',this.object+='<source src="'+this.options.mp3_url+'">',this.object+='<source src="'+this.options.wav_url+'">',this.object+="</audio>"),$("body").append(this.object),this.video=$("[name='"+this.options.mp3_url+"']")[0],$.browser.msie?"undefined"==typeof Worker?this.video.attachEvent("PlayStateChange",function(t){switch(t){case 1:e.options.onStop();break;case 2:e.options.onPause()}}):(this.video.attachEvent("ended",function(){e.options.onStop()}),this.video.attachEvent("pause",function(){e.options.onPause()})):"undefined"==typeof Worker?this.video.addEventListener("PlayStatusChange",function(t){switch(t){case 1:e.options.onStop();break;case 2:e.options.onPause()}}):(this.video.addEventListener("ended",function(){e.options.onStop()}),this.video.addEventListener("pause",function(){e.options.onPause()}))):this.video=$("#"+this.options.mp3_url),this.play=function(){"undefined"==typeof Worker?this.video.controls.play():this.video.play()},this.stop=function(){"undefined"==typeof Worker?this.video.controls.stop():(this.video.pause(),this.video.currentTime>0&&(this.video.currentTime=0),this.options.onStop())},this.pause=function(){"undefined"==typeof Worker?this.video.controls.pause():this.video.pause()},this.getAllTime=function(){if("undefined"==typeof Worker){var t=this.video.currentMedia;return t?t.duration:0}return this.video.duration},this.getCurrentTime=function(){if("undefined"==typeof Worker){var t=this.video.currentMedia;return t?t.currentTime:0}return this.video.currentTime}}return t});